<!DOCTYPE html>
  <head>
    <title>AB Paradigm</title>
    <script src="jsPsych/jspsych.js"></script>
    <script src="jsPsych/plugins/jspsych-html-keyboard-response.js"></script>
    <script src="jsPsych/plugins/jspsych-image-keyboard-response.js"></script>
    <script src="jsPsych/plugins/jspsych-fullscreen.js"></script>
    <script src="jsPsych/plugins/jspsych-instructions.js"></script>
	<script src="jsPsych/plugins/jspsych-survey-multi-choice.js"></script>
	<script src="jsPsych/plugins/jspsych-resize.js"></script>
	<script src="jsPsych/plugins/jspsych-virtual-chinrest.js"></script>
    <link href="jsPsych/css/jspsych.css" rel="stylesheet" type="text/css">
  </head>
  <body></body>
  <script>

//Code adapted from paulsharpeY by Jordan Wylie & Dries Bostyn

///////////////////////////////////////////////////////
var rsvp_task = []; // main timeline

var welcome = {
      type: "html-keyboard-response",
      stimulus: '<div style="color:black;font-size:40px;line-height:1.5">Welcome to our experiment! Please turn off any music or television, and put your phone on silent. This experiment will take about 15-20 minutes. <p>Press any key to begin.</p></div>',
    };
    rsvp_task.push(welcome);

///////////////////////////////////////////////////////
/* Computer things */

rsvp_task.push({
  type: 'fullscreen',
  fullscreen_mode: true
});

var compSize = {
  type: 'resize',
  item_width: 3 + 3/8,
  item_height: 2 + 1/8,
  prompt: "<p>First, we need to adjust the dimensions of the experiment to fit your screen. Click and drag the lower right corner of the box until the box is the same size as any credit card you have held up to the screen.</p>",
  pixels_per_unit: 150
};
rsvp_task.push(compSize);

// no blindspot task
// resize to cm (50 pixels per unit)
// measure px2mm, but not viewing distance and px2deg (because blindspot_reps is 0)
// note: you may still choose to estimate viewing distance even if resizing to cm or inches
let cm_resize = {
  type: "virtual-chinrest",
  blindspot_reps: 0,
  resize_units: "cm",
  pixels_per_unit: 50,
};
rsvp_task.push(cm_resize);

///////////////////////////////////////////////////////

//////////////////////////////////////
/* define instructions trial */
//////////////////////////////////////

var instructionsGEN = {
      type: "instructions",
      pages: ['<div style="color:black;font-size:30px;line-height:1.5"> This experiment tests your memory about words. </p>' +
          " <p> First, you will read a short passage and answer some questions.</p>"+ 
          ' <p> Then, you will be tested on your ability to remember two words that appear in <b>green</b>. We will begin with a practice trial that uses letters and numbers. </p>' +
          " <p><b>Please press the right arrow key to continue. </b></p></div>"],
        key_forward: 'rightarrow',
      post_trial_gap: 1500
    };
	rsvp_task.push(instructionsGEN);

// instructions
var instructions_prac = {
  type: "html-keyboard-response",
  stimulus: "<div class='instructions'><p>You will see a series of letters and numbers rapidly " +
            "appearing on the computer screen. Your task is to remember " +
            "the digits in the series.</p><p>When the series ends, you have to " +
            "respond to the question ‘which two digits did you see?’</p><p>You " +
            "type in the digits you saw (order does not matter), and then " +
            "another series will appear.</p>" +
            "<p>Press any key to see an example of the task.</p></div>",
  data: {test_part: 'instructions'},
  post_trial_gap: 1000
};
rsvp_task.push(instructions_prac);

// make slow instruction trial
rsvp_task.push(make_rsvp_timeline([ {t1_location: 8, lag: 3} ], 'instructions'));

var instructions_prac2 = {
  type: "html-keyboard-response",
  stimulus: "<div class='instructions'><p>In the example you just saw, " +
            "the letters and numbers appeared quite slowly.</p>" +
            "<p>The real task is more challenging, as the words " +
            "will appear much more rapidly.</p>" +
            "<p>You will have some time to practice before starting the test.</p>" +
            "<p>Press any key to start the practice.</p></div>",
  data: {test_part: 'instructions'},
  post_trial_gap: 1000
};
rsvp_task.push(instructions_prac2);

var instructionsCond = {
      type: "instructions",
      pages: ['<div style="color:black;font-size:30px;line-height:1.5"> We will now present you with a short newspaper article to read. After you finish the article, you will be asked to craft an argument about it.' +
        '<b><p> Please press the right arrow key to continue. </p></b></div>'],
        key_forward: 'rightarrow',
      post_trial_gap: 1500
    };
	rsvp_task.push(instructionsCond);

///////////////////////////////////////////////////////
// AB stimuli -- word lists 
var response_choices = keyCodeRange('f', 'j');

var targetsAuthority = [
    { target: 'accuse', type: 'Authority'},
    { target: 'agitate' , type: 'Authority'},
    { target: 'alienate', type: 'Authority'},
    { target: 'anarchist',type: 'Authority'},
    { target: 'banning', type: 'Authority'},
    { target: 'bedlam', type: 'Authority'},
    { target: 'chaotic', type: 'Authority'},
    { target: 'contempt', type: 'Authority'},
    { target: 'counter', type: 'Authority'},
    { target: 'defector', type: 'Authority'},
    { target: 'defiant',type: 'Authority'},
    { target: 'defying', type: 'Authority'},
    { target: 'demonstrator', type: 'Authority'},
    { target: 'denounce', type: 'Authority'},
    { target: 'disarray', type: 'Authority'},
    { target: 'dishonorable', type: 'Authority'},
    { target: 'disobeying', type: 'Authority'},
    { target: 'disorder', type: 'Authority'},
    { target: 'disrespect', type: 'Authority'},
    { target: 'disruption', type: 'Authority'},
    { target: 'dissenting', type: 'Authority'},
    { target: 'dissident', type: 'Authority'},
    { target: 'flag', type: 'Authority'},
    { target: 'fossil', type: 'Authority'},
    { target: 'heretical', type: 'Authority'},
    { target: 'illegal', type: 'Authority'},
    { target: 'impolite', type: 'Authority'},
    { target: 'insubordinate', type: 'Authority'},
    { target: 'insurgent', type: 'Authority'},
    { target: 'insurrection', type: 'Authority'},
    { target: 'intimidation', type: 'Authority'},
    { target: 'lawless', type: 'Authority'},
    { target: 'misrule', type: 'Authority'},
    { target: 'mutiny', type: 'Authority'},
    { target: 'nonconforming', type: 'Authority'},
    { target: 'obstruct', type: 'Authority'},
    { target: 'oppose', type: 'Authority'},
    { target: 'orders', type: 'Authority'},
    { target: 'overpowering', type: 'Authority'},
    { target: 'overthrowing', type: 'Authority'},
    { target: 'pandemonium', type: 'Authority'},
    { target: 'protesting', type: 'Authority'},
    { target: 'rabble rousing', type: 'Authority'},
    { target: 'raising hell', type: 'Authority'},
    { target: 'rebelling', type: 'Authority'},
    { target: 'refusing', type: 'Authority'},
    { target: 'remonstrate', type: 'Authority'},
    { target: 'renegades', type: 'Authority'},
    { target: 'resist', type: 'Authority'},
    { target: 'rioting', type: 'Authority'},
    { target: 'rock the boat', type: 'Authority'},
    { target: 'scheme', type: 'Authority'},
    { target: 'sedition', type: 'Authority'},
    { target: 'subverting', type: 'Authority'},
    { target: 'supremacy', type: 'Authority'},
    { target: 'transgression', type: 'Authority'},
    { target: 'trouble maker', type: 'Authority'},
    { target: 'tumultuous', type: 'Authority'},
    { target: 'unauthorized', type: 'Authority'},
    { target: 'unlawfully', type: 'Authority'},
    { target: 'unruly', type: 'Authority'},
    { target: 'uprising', type: 'Authority'},
    { target: 'violate', type: 'Authority'}
    ]

var targetsFairness = [
    { target: 'behind their back', type: 'Fairness'},
    { target: 'biased', type: 'Fairness'},
    { target: 'bigoted', type: 'Fairness'},
    { target: 'bilking', type: 'Fairness'},
    { target: 'blackmailing', type: 'Fairness'},
    { target: 'chauvinists', type: 'Fairness'},
    { target: 'cheating', type: 'Fairness'},
    { target: 'con artist', type: 'Fairness'},
    { target: 'conniving', type: 'Fairness'},
    { target: 'corrupt', type: 'Fairness'},
    { target: 'crook', type: 'Fairness'},
    { target: 'deception', type: 'Fairness'},
    { target: 'defrauding', type: 'Fairness'},
    { target: 'disadvantaged', type: 'Fairness'},
    { target: 'discrimination', type: 'Fairness'},
    { target: 'dishonest', type: 'Fairness'},
    { target: 'disparity', type: 'Fairness'},
    { target: 'disproportionate', type: 'Fairness'},
    { target: 'distrustful', type: 'Fairness'},
    { target: 'double crossing', type: 'Fairness'},
    { target: 'duplicitous', type: 'Fairness'},
    { target: 'exclude', type: 'Fairness'},
    { target: 'false advertising', type: 'Fairness'},
    { target: 'false witness', type: 'Fairness'},
    { target: 'favoritism', type: 'Fairness'},
    { target: 'fleecing', type: 'Fairness'},
    { target: 'fraudulent', type: 'Fairness'},
    { target: 'free rider', type: 'Fairness'},
    { target: 'freeloading', type: 'Fairness'},
    { target: 'hoodwinking', type: 'Fairness'},
    { target: 'hypocrite', type: 'Fairness'},
    { target: 'imbalance', type: 'Fairness'},
    { target: 'imposters', type: 'Fairness'},
    { target: 'inequality', type: 'Fairness'},
    { target: 'inequity', type: 'Fairness'},
    { target: 'injustice', type: 'Fairness'},
    { target: 'lying', type: 'Fairness'},
    { target: 'mislead', type: 'Fairness'},
    { target: 'misogyny', type: 'Fairness'},
    { target: 'mooching', type: 'Fairness'},
    { target: 'oppression', type: 'Fairness'},
    { target: 'partiality', type: 'Fairness'},
    { target: 'pickpocketing', type: 'Fairness'},
    { target: 'plagiarize', type: 'Fairness'},
    { target: 'prejudiced', type: 'Fairness'},
    { target: 'restrictive', type: 'Fairness'},
    { target: 'ripoff', type: 'Fairness'},
    { target: 'robbed', type: 'Fairness'},
    { target: 'scamming', type: 'Fairness'},
    { target: 'segregating', type: 'Fairness'},
    { target: 'sexism', type: 'Fairness'},
    { target: 'shyster', type: 'Fairness'},
    { target: 'steal', type: 'Fairness'},
    { target: 'suckered', type: 'Fairness'},
    { target: 'swindles', type: 'Fairness'},
    { target: 'thieving', type: 'Fairness'},
    { target: 'tricking', type: 'Fairness'},
    { target: 'unequal', type: 'Fairness'},
    { target: 'unfair', type: 'Fairness'},
    { target: 'uninsured', type: 'Fairness'},
    { target: 'unjust', type: 'Fairness'},
    { target: 'unscrupulous', type: 'Fairness'},
    { target: 'untrustworthy', type: 'Fairness'}
    ]

var distractors = [
      {distractor: 'violate', type: 'Neutral',
      distractor: 'alike', type: 'Neutral',
      distractor: 'along', type: 'Neutral',
      distractor: 'apply', type: 'Neutral',
      distractor: 'asset', type: 'Neutral',
      distractor: 'bunch', type: 'Neutral',
      distractor: 'coast', type: 'Neutral',
      distractor: 'drum', type: 'Neutral',
      distractor: 'even', type: 'Neutral',
      distractor: 'foam', type: 'Neutral',
      distractor: 'focu', type: 'Neutral',
      distractor: 'form', type: 'Neutral',
      distractor: 'hike', type: 'Neutral',
      distractor: 'hint', type: 'Neutral',
      distractor: 'icon', type: 'Neutral',
      distractor: 'maze', type: 'Neutral',
      distractor: 'novel', type: 'Neutral',
      distractor: 'olive', type: 'Neutral',
      distractor: 'pile', type: 'Neutral',
      distractor: 'press', type: 'Neutral',
      distractor: 'scale', type: 'Neutral',
      distractor: 'shape', type: 'Neutral',
      distractor: 'solid', type: 'Neutral',
      distractor: 'suite', type: 'Neutral',
      distractor: 'swing', type: 'Neutral',
      distractor: 'tile', type: 'Neutral',
      distractor: 'title', type: 'Neutral',
      distractor: 'walk', type: 'Neutral',
      distractor: 'wave', type: 'Neutral'}
    ]

//////////////////////////////////////
//* Between Subjects Cond 1 = ??
// to do: replace this with the actual condition information/vignettes

var vignette1 = [
      {
      }]

var between1 = {
        type: 'image-keyboard-response',
        stimulus: jsPsych.timelineVariable('img'),
        choices: jsPsych.NO_KEYS,
        trial_duration: 3000
      };
var bw_procedure1 = {
    timeline: [fixation, encode1],
    timeline_variables: vignette1, 
    randomize_order: true 
};

//* Between Cond 2 = ??

var vignette2 = [
      {
      }]

var between2 = {
        type: 'image-keyboard-response',
        stimulus: jsPsych.timelineVariable('img2'),
        choices: jsPsych.NO_KEYS,
        trial_duration: 3000
      };

  var bw_procedure2 = {
      timeline: [fixation, encode2],
      timeline_variables: vignette2,
      randomize_order: true
  };

//* Set up conditions */
//////////////////////////////////////

var conditions = [encode_procedure1, encode_procedure2];
var cond = jsPsych.randomization.sampleWithoutReplacement(conditions,1)[0];
console.log('condition: ', cond);  // check console to see which condition was selected
rsvp_task.push(cond);

//////////////////////////////////////

var instructions_main = {
  type: "html-keyboard-response",
  stimulus: "<div class='instructions'><p>We will now begin the main experimental task." +
            "Your task is to find words that appear in green.</p>" +
            "<p>Occasionally, you will be asked to type <b>2</b> words that were in green.</p>" +
            "<p>When that happens, it doesn't matter what order you type the words. </p>" +
            "<p>If you don't remember a word, you can indicate that by pressing the '1' key</p>" +
            "<p>Press any key to begin the experiment.</p></div>",
  data: {test_part: 'instructions'},
  post_trial_gap: 1000
};
rsvp_task.push(instructions_main);

//////////////////////////////////////
// stimuli definitions

var fixation = {
        type: 'html-keyboard-response',
        stimulus: '<div style="font-size:60px;">+</div>',
        choices: jsPsych.NO_KEYS,
        trial_duration: function(){
          return jsPsych.randomization.sampleWithReplacement([250, 500, 750, 1000, 1250, 1500], 1)[0];
        },
		data: {test_part: 'fixation'}
      };

var rsvp_iti = {
    type: 'html-keyboard-response',
    stimulus: '<span></span>',
    choices: jsPsych.NO_KEYS,
    trial_duration: 30,
    data: {test_part: 'iti'}
};
var rsvp_demo_iti = {
    type: 'html-keyboard-response',
    stimulus: '<span></span>',
    choices: jsPsych.NO_KEYS,
    trial_duration: 90,
    data: {test_part: 'iti'}
};
var blank = {
  type: 'html-keyboard-response',
  stimulus: '<div class="rsvp"></div>',
  choices: jsPsych.NO_KEYS,
  trial_duration: 250,
  data: {test_part: 'blank'}
}
var rsvp_stimulus_block = {
    type: 'html-keyboard-response',
    stimulus: jsPsych.timelineVariable('stimulus'),
    choices: jsPsych.NO_KEYS,
    trial_duration: 70,
    data: jsPsych.timelineVariable('data'),
};
var rsvp_demo_stimulus_block = {
    type: 'html-keyboard-response',
    stimulus: jsPsych.timelineVariable('stimulus'),
    choices: jsPsych.NO_KEYS,
    trial_duration: 210,
    data: jsPsych.timelineVariable('data'),
};
var response_block = {
  type: "html-keyboard-response",
  stimulus: jsPsych.timelineVariable('stimulus'),
  prompt: jsPsych.timelineVariable('prompt'),
  choices: response_choices,
  data: jsPsych.timelineVariable('data'),
  trial_duration: 5000,
  on_finish: function(data) {
    data.correct = data.correct_responses.includes(data.key_press); // accuracy irrespective of order
    if ( ! data.lag ) {                                             // only T2 has a lag
	    data.t1_correct = data.correct_response == data.key_press;  // T1 accuracy
	} else {
	    data.t2_correct = data.correct_response == data.key_press;  // T2 accuracy
	}
  }
}

//////////////////////////////////////////////////////////
// Factorial design
// 3 locations x 3 lags = 9
// this isn't fixed yet....
var factors = {
    t1_location: [7, 8, 9],
    lag: [1, 3, 5]
};
var practice_repetitions = 2;
var test_repetitions     = 15;
var practice_block       = 0;

var performance_block = {
  type: "html-keyboard-response",
  stimulus: function() {
  	var practice_trials = practice_repetitions * 12;
  	var correct         = 0;
  	for (i = 1; i <= practice_trials; i++) {
  		var trials         = jsPsych.data.get().filter({phase: 'practice' + practice_block});
	    trials             = trials.filter({trial_number: i});
		var correct_trials = trials.filter({correct: true});
		if (correct_trials.count() > 1) correct++;
  	}
    var accuracy = Math.round(correct / practice_trials * 100);
    if (accuracy >= 50) {
    	// practice accuracy achieved, so build test trials
    	var test_timeline = make_rsvp_timeline(jsPsych.randomization.factorial(factors, test_repetitions), 'test');
		jsPsych.addNodeToEndOfTimeline(test_timeline, function(){});
		var thanks = {
		  type: "html-keyboard-response",
		  stimulus: "<div class='instructions'><p>Thank you for completing this task.</p><p>Press any key to continue.</p></div>",
		  trial_duration: 10000,
		  data: {test_part: 'end'}
		};
		jsPsych.addNodeToEndOfTimeline(thanks, function(){});
		var feedback = "<div class='instructions'><p>Well done!  You responded correctly on "+accuracy+"% of the trials.</p>" +
	    "<p>Press any key to start the test.</p></div>";
    } else {
    	// practice accuracy too low, so repeat practice
    	practice_block++;
    	var practice_timeline = make_rsvp_timeline(jsPsych.randomization.factorial(factors, practice_repetitions), 'practice' + practice_block);
    	practice_timeline.timeline.push(performance_block);
    	jsPsych.addNodeToEndOfTimeline(practice_timeline, function(){});
	    var feedback = "<div class='instructions'><p>You responded correctly on "+accuracy+"% of the trials.</p>" +
	    "<p>You need to score at least 50% before starting the test.</p>" +
	    "<p>Press any key to repeat the practice.</p></div>";
	}
	return feedback;
  }
};
// make initial practice block
rsvp_task.push(make_rsvp_timeline(jsPsych.randomization.factorial(factors, practice_repetitions), 'practice' + practice_block));
rsvp_task.push(performance_block);

/** functions **/
function alphabetRange (start, end) {
  return new Array(end.charCodeAt(0) - start.charCodeAt(0) + 1).fill().map((d, i) => String.fromCharCode(i + start.charCodeAt(0)));
}
function keyCodeRange (start, end) {
	var start = start.charCodeAt(0);
  return new Array(end.charCodeAt(0) - start + 1).fill().map((d, i) => i + start);
}

///////////////////////////////////////////////////////////////
//this isn't right yet....
function rsvp_trial(o) {
	var stimuli                    = jsPsych.randomization.sampleWithoutReplacement(distractors, 10);
  var tar = [targetsAuthority, targetsFairness];
	var targets                    = jsPsych.randomization.sampleWithoutReplacement(tar, 1);
	stimuli[o.t1_location]         = targets[0];
	stimuli[o.t1_location + o.lag] = targets[1];

	return({stimuli: stimuli, targets: targets.map(jsPsych.pluginAPI.convertKeyCharacterToKeyCode)});
}

///////////////////////////////////////////////////////////////
// Make a block of RSVP stimuli and responses

//havent attempted this yet....

function make_rsvp_timeline(trials, phase) {
	rsvp_timeline = [];
	trial_number  = 0;
	for (trial in trials) {
		trial_number++;
		rsvp_stimuli = rsvp_trial(trials[trial]);

		// RSVP: 20 distractors, 10 targets targets
		var rsvp_block_stimuli = [];
		for (stimulus in rsvp_stimuli.stimuli) {
			rsvp_block_stimuli.push(
	  			{
	  				stimulus: "<span class='rsvp'>" + rsvp_stimuli.stimuli[stimulus] + "</span>",
	  				data: {
	  					phase: phase,
	  					test_part: 'rsvp',
	  					stim: rsvp_stimuli.stimuli[stimulus],
	  					trial_number: trial_number
	  				}
	  			}
	  		);
		}
		// attach RSVP stimuli to a timeline
		if (phase == 'instructions') {
			// slow stimuli
			stimulus_trial = rsvp_demo_stimulus_block;
			iti_trial      = rsvp_demo_iti;
		} else {
			stimulus_trial = rsvp_stimulus_block;
			iti_trial      = rsvp_iti;
		}
		var test_procedure = {
			timeline: [stimulus_trial, iti_trial],
			timeline_variables: rsvp_block_stimuli
		}

		// 2 responses
	  	var rsvp_response_stimuli = [];
	  	// T1
	  	rsvp_response_stimuli.push(
			{
				stimulus:'<div class="rsvp">Whose face did you see?</div>',
				prompt: '<p class="rsvp">(type in the name of the person you saw)</p>',
				data: {
					phase: phase,
					test_part: 'response',
					correct_responses: rsvp_stimuli.targets,
					correct_response: rsvp_stimuli.targets[0],
					trial_number: trial_number
				}
			}
		);
	  	// T2
		rsvp_response_stimuli.push(
			{
				stimulus:'<div class="rsvp">v</div>',
				prompt: '<p class="rsvp">(type in the name of the person you saw)</p>',
				data: {
					phase: phase,
					test_part: 'response',
					correct_responses: rsvp_stimuli.targets,
					correct_response: rsvp_stimuli.targets[1],
					lag: trials[trial].lag,
					trial_number: trial_number
				}
			}
		);
		// attach responses to timeline
		var response_procedure = {
			timeline: [response_block],
			timeline_variables: rsvp_response_stimuli
		}
		rsvp_timeline.push(fixation);
		rsvp_timeline.push(blank);
		rsvp_timeline.push(test_procedure);
		rsvp_timeline.push(response_procedure);
	}
	return { timeline: rsvp_timeline }
}

////////////////////////////////////////////////////////////////
var Genderq = ["Man", "Woman", "Non-binary", "Other", "Prefer not to answer"];
var PolIDq = ["Extremely Liberal", " ", " ", " Neither", " ", " ", "Extremely Conservative"];
var Relq = ["Not at all Religious", " ", " ", " ", " ", " ", "Extremely Religious"];
var Incomeq = ["Less than $10,000 USD a year", "$10,000 - $20,000 USD", "$20,000-$40,000 USD", "$40,000-$60,000 USD", "$60,000-$80,000 USD", "$80,000-$100,000 USD", "$100,000 USD a year or more"];
var Raceq = ["White, not hispanic or latinx", "Black or African American", "Asian", "American Indian or Alaska Native", "Native Hawaiian or Other Pacific Islander", "Hispanic or Latinx", "Two or more", "Not listed"];
var Demand1q = ["Not at all", " ", " ", " ", "Very much so"];
var compTypeq = ["Laptop/Desktop", "Ipad/Tablet", "Other"];

var demo_Age = {
        type: 'survey-text',
        questions: [
        {prompt: 'How old are you?', columns: 3, required: true, name: 'Age'},
        {prompt: 'What is your religious affiliation?', columns: 50, name: 'Religious Affiliation'}
        ],
        randomize_question_order: true
        };

var demo_gen = {
        type: 'survey-multi-choice',
        questions: [
            {prompt: '<p style="text-align: left;font-size:20px;">What is your Gender?</p>', options: Genderq, required: true, horizontal: true,}, 
            {prompt: '<p style="text-align: left;font-size:20px;">Which of the following items BEST describes your ethnic or racial background?</p>', options: Raceq, required: true, horizontal: true},
            {prompt: '<p style="text-align: left;font-size:20px;">How religious would you consider yourself?</p>', options: Relq, required: true, horizontal: true,}, 
            {prompt: '<p style="text-align: left;font-size:20px;">What is your household income?</p>', options: Incomeq, required: true, horizontal: true}
          ],
        randomize_question_order: true,
        preamble: '<p style="text-align: left;font-size:28px;"Using the scales provided, please respond to each question about you as an individual.</p>'
        };

var demo_PolIQ = {
        type: 'survey-multi-choice',
        questions: [
            {prompt: '<p style="text-align: left;font-size:20px;">Which response best captures your political beliefs surrounding economic issues?</p>', options: PolIDq, required: true, horizontal: true,}, 
            {prompt: '<p style="text-align: left;font-size:20px;">Which response best captures your political beliefs surrounding social issues?</p>', options: PolIDq, required: true, horizontal: true},
            {prompt: '<p style="text-align: left;font-size:20px;">When it comes to overall political issues, you consider yourself to be a:</p>', options: PolIDq, required: true, horizontal: true,}
        ],
        randomize_question_order: true,
        preamble: '<p style="text-align: left;font-size:28px;"Please answer the following questions about your political ideology.</p>'
        };

var demo_FinalQs = {
        type: 'survey-multi-choice',
        questions: [
            {prompt: '<p style="text-align: left;font-size:20px;">What kind of device did you use to complete this study?</p>', options: compTypeq, required: true, horizontal: true,}, 
            {prompt: '<p style="text-align: left;font-size:20px;">Did you feel pressure to respond in a particular way to any of the questions?</p>', options: Demand1q, required: true, horizontal: true,}, 
            {prompt: '<p style="text-align: left;font-size:20px;">Did you feel as though you might be judged for your responses to the questions you answered.</p>', options: Demand1q, required: true, horizontal: true}        
          ],
        randomize_question_order: true,
        preamble: '<p style="text-align: left;font-size:28px;"For these final questions, please answer as honestly as you can! The answers to these questions will not affect whether or not you receive credit/payment for participation!</p>'
        };

//////////////////////////////////////////////////////////////
rsvp_timeline.push(demo_Age);
rsvp_timeline.push(demo_gen);
rsvp_timeline.push(demo_PolIQ);
rsvp_timeline.push(demo_FinalQs);

////////////////////////////////////////////////////////////////
///* define debrief */

var debrief = {
      type: "html-keyboard-response",
      stimulus: "<p>Thank you for your participation!</p>" + 
      "<p>Some things.",
      post_trial_gap: 2000
    };
    tl.push(debrief);

////////////////////////////////////////////////////////////////
/* start the experiment */
jsPsych.init({
  timeline: rsvp_timeline
});

</script>